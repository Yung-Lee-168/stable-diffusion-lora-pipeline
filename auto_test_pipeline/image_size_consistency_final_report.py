#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
åœ–ç‰‡å°ºå¯¸è™•ç†ä¸€è‡´æ€§æœ€çµ‚é©—è­‰
æª¢æŸ¥æ•´å€‹ LoRA è¨“ç·´ pipeline ä¸­åœ–ç‰‡å°ºå¯¸è™•ç†çš„ä¸€è‡´æ€§
"""

import os
import sys

def main():
    """æª¢æŸ¥æ•´å€‹ pipeline ä¸­åœ–ç‰‡å°ºå¯¸è™•ç†çš„ä¸€è‡´æ€§"""
    
    print("ğŸ” LoRA è¨“ç·´ Pipeline åœ–ç‰‡å°ºå¯¸è™•ç†ä¸€è‡´æ€§æª¢æŸ¥")
    print("=" * 80)
    
    # 1. é è™•ç†éšæ®µ - generate_caption_fashionclip.py
    print("\nğŸ“‹ 1. é è™•ç†éšæ®µ (generate_caption_fashionclip.py)")
    print("   ğŸ¯ åœ–ç‰‡å°ºå¯¸è¦æ±‚: â‰¤ 512x512 åƒç´ ")
    print("   ğŸ“ è™•ç†æ–¹å¼:")
    print("      â€¢ æª¢æŸ¥åŸå§‹åœ–ç‰‡å°ºå¯¸")
    print("      â€¢ å¦‚æœ â‰¤ 512x512: ç›´æ¥è¤‡è£½åˆ°è¨“ç·´ç›®éŒ„")
    print("      â€¢ å¦‚æœ > 512x512: ç¸®æ”¾åˆ° â‰¤ 512x512 (ä¿æŒé•·å¯¬æ¯”)")
    print("   âœ… çµæœ: æ‰€æœ‰è¨“ç·´åœ–ç‰‡éƒ½ â‰¤ 512x512")
    
    # 2. è¨“ç·´å‰æª¢æŸ¥ - train_lora.py
    print("\nğŸ“‹ 2. è¨“ç·´å‰æª¢æŸ¥ (train_lora.py)")
    print("   ğŸ¯ check_image_size() å‡½æ•¸:")
    print("      â€¢ æª¢æŸ¥æ‰€æœ‰è¨“ç·´åœ–ç‰‡ â‰¤ 512x512")
    print("      â€¢ æ‹’çµ•è™•ç†è¶…å‡ºå°ºå¯¸çš„åœ–ç‰‡")
    print("      â€¢ è¨“ç·´è§£æåº¦è¨­å®š: --resolution=512,512")
    print("   âœ… çµæœ: ç¢ºä¿è¨“ç·´åœ–ç‰‡ç¬¦åˆ SD æ¨¡å‹è¦æ±‚")
    
    # 3. è¨“ç·´éç¨‹ - day3_fashion_training.py
    print("\nğŸ“‹ 3. è¨“ç·´éç¨‹æŒ‡æ¨™è¨ˆç®— (day3_fashion_training.py)")
    print("   ğŸ¯ calculate_image_similarity() æ–¹æ³•:")
    print("      â€¢ SSIM è¨ˆç®—: ä½¿ç”¨ min(shape) å°é½Šå°ºå¯¸")
    print("      â€¢ è‰²å½©ç›´æ–¹åœ–: ä½¿ç”¨åŸå§‹åœ–ç‰‡å°ºå¯¸")
    print("      â€¢ FashionCLIP: ä½¿ç”¨åŸå§‹åœ–ç‰‡å°ºå¯¸ (æ¨¡å‹å…§éƒ¨è™•ç†)")
    print("   âœ… çµæœ: ä¸‰å€‹æŒ‡æ¨™ä½¿ç”¨ä¸€è‡´çš„å°ºå¯¸è™•ç†é‚è¼¯")
    
    # 4. è©•ä¼°éšæ®µ - analyze_results.py
    print("\nğŸ“‹ 4. è©•ä¼°éšæ®µ (analyze_results.py)")
    print("   ğŸ¯ åœ–ç‰‡ç›¸ä¼¼åº¦è¨ˆç®—:")
    print("      â€¢ SSIM: ä½¿ç”¨ min(shape) å°é½Šå°ºå¯¸ (èˆ‡è¨“ç·´ä¸€è‡´)")
    print("      â€¢ è‰²å½©ç›´æ–¹åœ–: ä½¿ç”¨åŸå§‹åœ–ç‰‡å°ºå¯¸ (èˆ‡è¨“ç·´ä¸€è‡´)")
    print("      â€¢ FashionCLIP: ä½¿ç”¨åŸå§‹åœ–ç‰‡å°ºå¯¸ (èˆ‡è¨“ç·´ä¸€è‡´)")
    print("   âœ… çµæœ: èˆ‡è¨“ç·´éç¨‹å®Œå…¨ç›¸åŒçš„è™•ç†æ–¹å¼")
    
    # 5. ä¸€è‡´æ€§ç¢ºèª
    print("\nğŸ“Š 5. ä¸€è‡´æ€§ç¢ºèª")
    print("   âœ… æ‰€æœ‰éšæ®µéƒ½éµå¾ªç›¸åŒçš„åœ–ç‰‡å°ºå¯¸é‚è¼¯:")
    print("      â€¢ é è™•ç†: ç¢ºä¿åœ–ç‰‡ â‰¤ 512x512")
    print("      â€¢ è¨“ç·´æª¢æŸ¥: é©—è­‰åœ–ç‰‡ â‰¤ 512x512")
    print("      â€¢ è¨“ç·´æŒ‡æ¨™: SSIM ç”¨ min(shape), å…¶ä»–ç”¨åŸå°ºå¯¸")
    print("      â€¢ è©•ä¼°æŒ‡æ¨™: SSIM ç”¨ min(shape), å…¶ä»–ç”¨åŸå°ºå¯¸")
    
    # 6. å…·é«”å¯¦ç¾å°æ¯”
    print("\nğŸ”„ 6. å…·é«”å¯¦ç¾å°æ¯”")
    print("   ğŸ“ SSIM è¨ˆç®— (è¨“ç·´ vs è©•ä¼°):")
    print("      è¨“ç·´: cv2.resize(gray, (target_shape[1], target_shape[0]))")
    print("      è©•ä¼°: cv2.resize(gray, (target_shape[1], target_shape[0]))")
    print("      âœ… å®Œå…¨ä¸€è‡´")
    
    print("\n   ğŸ“ è‰²å½©ç›´æ–¹åœ– (è¨“ç·´ vs è©•ä¼°):")
    print("      è¨“ç·´: cv2.calcHist([rgb], [0,1,2], None, [32,32,32], [0,256,0,256,0,256])")
    print("      è©•ä¼°: cv2.calcHist([rgb], [0,1,2], None, [32,32,32], [0,256,0,256,0,256])")
    print("      âœ… å®Œå…¨ä¸€è‡´")
    
    print("\n   ğŸ“ FashionCLIP (è¨“ç·´ vs è©•ä¼°):")
    print("      è¨“ç·´: æ¨™ç±¤åŒ¹é… (0.7*label_match + 0.3*confidence_similarity)")
    print("      è©•ä¼°: æ¨™ç±¤åŒ¹é… (0.7*label_match + 0.3*confidence_similarity)")
    print("      âœ… å®Œå…¨ä¸€è‡´")
    
    # 7. æœ€çµ‚çµè«–
    print("\nğŸ¯ 7. æœ€çµ‚çµè«–")
    print("   âœ… åœ–ç‰‡å°ºå¯¸è™•ç†åœ¨æ•´å€‹ pipeline ä¸­å®Œå…¨ä¸€è‡´")
    print("   âœ… ä¸‰å€‹å“è³ªæŒ‡æ¨™ (SSIM, è‰²å½©, FashionCLIP) ä½¿ç”¨ç›¸åŒçš„å°ºå¯¸é‚è¼¯")
    print("   âœ… è¨“ç·´å’Œè©•ä¼°éšæ®µä½¿ç”¨å®Œå…¨ç›¸åŒçš„è¨ˆç®—æ–¹æ³•")
    print("   âœ… æ‰€æœ‰åœ–ç‰‡éƒ½ç¶“éé è™•ç†ç¢ºä¿ â‰¤ 512x512")
    
    # 8. æŠ€è¡“ç´°ç¯€
    print("\nğŸ”§ 8. æŠ€è¡“ç´°ç¯€")
    print("   ğŸ“ åœ–ç‰‡å°ºå¯¸é™åˆ¶: â‰¤ 512x512 (SD v1.5 æ¨¡å‹è¦æ±‚)")
    print("   ğŸ“ SSIM å°é½Šç­–ç•¥: ä½¿ç”¨è¼ƒå°å°ºå¯¸é¿å…æ”¾å¤§å¤±çœŸ")
    print("   ğŸ“ è‰²å½©/FashionCLIP: ä¿æŒåŸå°ºå¯¸è®“æ¨¡å‹è‡ªè¡Œè™•ç†")
    print("   ğŸ“ ä¸€è‡´æ€§ä¿è­‰: æ‰€æœ‰è…³æœ¬ä½¿ç”¨ç›¸åŒçš„è™•ç†å‡½æ•¸")
    
    print("\n" + "=" * 80)
    print("ğŸ† LoRA è¨“ç·´ Pipeline åœ–ç‰‡å°ºå¯¸è™•ç†ä¸€è‡´æ€§æª¢æŸ¥å®Œæˆ")
    print("âœ… çµè«–: æ•´å€‹æµç¨‹ä¸­åœ–ç‰‡å°ºå¯¸è™•ç†å®Œå…¨ä¸€è‡´ä¸”æ­£ç¢º")

if __name__ == "__main__":
    main()
